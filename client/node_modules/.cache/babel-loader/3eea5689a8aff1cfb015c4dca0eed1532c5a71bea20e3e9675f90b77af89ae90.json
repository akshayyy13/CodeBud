{"ast":null,"code":"import _objectSpread from\"/Users/akshayshrivastava/Desktop/CodeBud/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{toast}from\"react-hot-toast\";import{setLoading,setToken}from\"../../slices/authSlice\";import{resetCart}from\"../../slices/cartSlice\";import{setUser}from\"../../slices/profileSlice\";import{apiConnector}from\"../apiconnector\";import{endpoints}from\"../apis\";import{useNavigate}from\"react-router-dom\";// import { Dispatch } from \"react\"\nconst{SENDOTP_API,SIGNUP_API,LOGIN_API,RESETPASSTOKEN_API,RESETPASSWORD_API}=endpoints;export function sendOtp(email,navigate){return async dispatch=>{const toastId=toast.loading(\"Loading...\");dispatch(setLoading(true));try{const response=await apiConnector(\"POST\",SENDOTP_API,{email,checkUserPresent:true});// console.log(\"SENDOTP API RESPONSE............\", response);\n// console.log(response.data.success);\nif(!response.data.success){throw new Error(response.data.message);}toast.success(\"OTP Sent Successfully\");navigate(\"/verify-email\");}catch(error){console.log(\"SENDOTP API ERROR............\",error);toast.error(\"Could Not Send OTP\");}dispatch(setLoading(false));toast.dismiss(toastId);};}export function signUp(accountType,firstName,lastName,email,password,confirmPassword,otp,navigate){return async dispatch=>{const toastId=toast.loading(\"Loading...\");dispatch(setLoading(true));try{const response=await apiConnector(\"POST\",SIGNUP_API,{accountType,firstName,lastName,email,password,confirmPassword,otp});// console.log(\"SIGNUP API RESPONSE............\", response);\nif(!response.data.success){throw new Error(response.data.message);}toast.success(\"Signup Successful\");navigate(\"/login\");}catch(error){console.log(\"SIGNUP API ERROR............\",error);toast.error(\"Signup Failed\");navigate(\"/signup\");}dispatch(setLoading(false));toast.dismiss(toastId);};}export function login(email,password,navigate){return async dispatch=>{const toastId=toast.loading(\"Loading...\");dispatch(setLoading(true));try{var _response$data,_response$data$user;const response=await apiConnector(\"POST\",LOGIN_API,{email,password});// console.log(\"LOGIN API RESPONSE............\", response);\nif(!response.data.success){throw new Error(response.data.message);}toast.success(\"Login Successful\");dispatch(setToken(response.data.token));const userImage=(_response$data=response.data)!==null&&_response$data!==void 0&&(_response$data$user=_response$data.user)!==null&&_response$data$user!==void 0&&_response$data$user.image?response.data.user.image:\"https://api.dicebear.com/5.x/initials/svg?seed=\".concat(response.data.user.firstName,\" \").concat(response.data.user.lastName);dispatch(setUser(_objectSpread(_objectSpread({},response.data.user),{},{image:userImage})));localStorage.setItem(\"token\",JSON.stringify(response.data.token));localStorage.setItem(\"user\",JSON.stringify(response.data.user));navigate(\"/dashboard/my-profile\");}catch(error){console.log(\"LOGIN API ERROR............\",error);toast.error(\"Login Failed\");}dispatch(setLoading(false));toast.dismiss(toastId);};}export function getPasswordResetToken(email,setEmailSent){return async dispatch=>{const toastId=toast.loading(\"Loading...\");dispatch(setLoading(true));try{const response=await apiConnector(\"POST\",RESETPASSTOKEN_API,{email});// console.log(\"RESETPASSTOKEN RESPONSE............\", response);\nif(!response.data.success){throw new Error(response.data.message);}toast.success(\"Reset Email Sent\");setEmailSent(true);}catch(error){console.log(\"RESETPASSTOKEN ERROR............\",error);toast.error(\"Failed To Send Reset Email\");}toast.dismiss(toastId);dispatch(setLoading(false));};}export function resetPassword(password,confirmPassword,token){return async dispatch=>{const toastId=toast.loading(\"Loading...\");dispatch(setLoading(true));try{const response=await apiConnector(\"POST\",RESETPASSWORD_API,{password,confirmPassword,token});// console.log(\"RESETPASSWORD RESPONSE............\", response);\nif(!response.data.success){throw new Error(response.data.message);}toast.success(\"Password Reset Successfully\");}catch(error){console.log(\"RESETPASSWORD ERROR............\",error);toast.error(\"Failed To Reset Password\");}dispatch(setLoading(false));toast.dismiss(toastId);};}export function logout(navigate){return dispatch=>{dispatch(setToken(null));dispatch(setUser(null));dispatch(resetCart());localStorage.removeItem(\"token\");localStorage.removeItem(\"user\");toast.success(\"Logged Out\");navigate(\"/\");};}","map":{"version":3,"names":["toast","setLoading","setToken","resetCart","setUser","apiConnector","endpoints","useNavigate","SENDOTP_API","SIGNUP_API","LOGIN_API","RESETPASSTOKEN_API","RESETPASSWORD_API","sendOtp","email","navigate","dispatch","toastId","loading","response","checkUserPresent","data","success","Error","message","error","console","log","dismiss","signUp","accountType","firstName","lastName","password","confirmPassword","otp","login","_response$data","_response$data$user","token","userImage","user","image","concat","_objectSpread","localStorage","setItem","JSON","stringify","getPasswordResetToken","setEmailSent","resetPassword","logout","removeItem"],"sources":["/Users/akshayshrivastava/Desktop/CodeBud/client/src/services/operations/authAPI.js"],"sourcesContent":["import { toast } from \"react-hot-toast\";\n\nimport { setLoading, setToken } from \"../../slices/authSlice\";\nimport { resetCart } from \"../../slices/cartSlice\";\nimport { setUser } from \"../../slices/profileSlice\";\nimport { apiConnector } from \"../apiconnector\";\nimport { endpoints } from \"../apis\";\nimport { useNavigate } from \"react-router-dom\";\n\n// import { Dispatch } from \"react\"\nconst {\n  SENDOTP_API,\n  SIGNUP_API,\n  LOGIN_API,\n  RESETPASSTOKEN_API,\n  RESETPASSWORD_API,\n} = endpoints;\n\nexport function sendOtp(email, navigate) {\n  return async (dispatch) => {\n    const toastId = toast.loading(\"Loading...\");\n    dispatch(setLoading(true));\n    try {\n      const response = await apiConnector(\"POST\", SENDOTP_API, {\n        email,\n        checkUserPresent: true,\n      });\n      // console.log(\"SENDOTP API RESPONSE............\", response);\n\n      // console.log(response.data.success);\n\n      if (!response.data.success) {\n        throw new Error(response.data.message);\n      }\n\n      toast.success(\"OTP Sent Successfully\");\n      navigate(\"/verify-email\");\n    } catch (error) {\n      console.log(\"SENDOTP API ERROR............\", error);\n      toast.error(\"Could Not Send OTP\");\n    }\n    dispatch(setLoading(false));\n    toast.dismiss(toastId);\n  };\n}\n\nexport function signUp(\n  accountType,\n  firstName,\n  lastName,\n  email,\n  password,\n  confirmPassword,\n  otp,\n  navigate\n) {\n  return async (dispatch) => {\n    const toastId = toast.loading(\"Loading...\");\n    dispatch(setLoading(true));\n    try {\n      const response = await apiConnector(\"POST\", SIGNUP_API, {\n        accountType,\n        firstName,\n        lastName,\n        email,\n        password,\n        confirmPassword,\n        otp,\n      });\n\n      // console.log(\"SIGNUP API RESPONSE............\", response);\n\n      if (!response.data.success) {\n        throw new Error(response.data.message);\n      }\n      toast.success(\"Signup Successful\");\n      navigate(\"/login\");\n    } catch (error) {\n      console.log(\"SIGNUP API ERROR............\", error);\n      toast.error(\"Signup Failed\");\n      navigate(\"/signup\");\n    }\n    dispatch(setLoading(false));\n    toast.dismiss(toastId);\n  };\n}\n\nexport function login(email, password, navigate) {\n  return async (dispatch) => {\n    const toastId = toast.loading(\"Loading...\");\n    dispatch(setLoading(true));\n    try {\n      const response = await apiConnector(\"POST\", LOGIN_API, {\n        email,\n        password,\n      });\n\n      // console.log(\"LOGIN API RESPONSE............\", response);\n\n      if (!response.data.success) {\n        throw new Error(response.data.message);\n      }\n\n      toast.success(\"Login Successful\");\n      dispatch(setToken(response.data.token));\n      const userImage = response.data?.user?.image\n        ? response.data.user.image\n        : `https://api.dicebear.com/5.x/initials/svg?seed=${response.data.user.firstName} ${response.data.user.lastName}`;\n      dispatch(setUser({ ...response.data.user, image: userImage }));\n      localStorage.setItem(\"token\", JSON.stringify(response.data.token));\n      localStorage.setItem(\"user\", JSON.stringify(response.data.user));\n      navigate(\"/dashboard/my-profile\");\n    } catch (error) {\n      console.log(\"LOGIN API ERROR............\", error);\n      toast.error(\"Login Failed\");\n    }\n    dispatch(setLoading(false));\n    toast.dismiss(toastId);\n  };\n}\n\nexport function getPasswordResetToken(email, setEmailSent) {\n  return async (dispatch) => {\n    const toastId = toast.loading(\"Loading...\");\n    dispatch(setLoading(true));\n    try {\n      const response = await apiConnector(\"POST\", RESETPASSTOKEN_API, {\n        email,\n      });\n\n      // console.log(\"RESETPASSTOKEN RESPONSE............\", response);\n\n      if (!response.data.success) {\n        throw new Error(response.data.message);\n      }\n\n      toast.success(\"Reset Email Sent\");\n      setEmailSent(true);\n    } catch (error) {\n      console.log(\"RESETPASSTOKEN ERROR............\", error);\n      toast.error(\"Failed To Send Reset Email\");\n    }\n    toast.dismiss(toastId);\n    dispatch(setLoading(false));\n  };\n}\n\nexport function resetPassword(password, confirmPassword, token) {\n  return async (dispatch) => {\n    const toastId = toast.loading(\"Loading...\");\n    dispatch(setLoading(true));\n    try {\n      const response = await apiConnector(\"POST\", RESETPASSWORD_API, {\n        password,\n        confirmPassword,\n        token,\n      });\n\n      // console.log(\"RESETPASSWORD RESPONSE............\", response);\n\n      if (!response.data.success) {\n        throw new Error(response.data.message);\n      }\n\n      toast.success(\"Password Reset Successfully\");\n\n    } catch (error) {\n      console.log(\"RESETPASSWORD ERROR............\", error);\n      toast.error(\"Failed To Reset Password\");\n    }\n    dispatch(setLoading(false));\n    toast.dismiss(toastId);\n\n  };\n}\n\nexport function logout(navigate) {\n  return (dispatch) => {\n    dispatch(setToken(null));\n    dispatch(setUser(null));\n    dispatch(resetCart());\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"user\");\n    toast.success(\"Logged Out\");\n    navigate(\"/\");\n  };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}